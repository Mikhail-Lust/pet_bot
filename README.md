# PET_BOT 

---
### PET_BOT - телеграм бот, который поможет тебе найти своего четвероногого друга!

---

> Цель продукта:
>
> в наше время огромное количество людей проводит своё время в telegram и множество продуктов уже интегрировано в его экосистему
>. наш бот предоставляет возможность выбрать друга из приюта не выходя из любимого мессенджера 
> 
> его может использовать абсолютно любой приют, но мы выбрали [этот](https://less-homeless.com/)

## Возможности бота: 

1. Главное меню 
![Screenshot_2025-05-03-21-19-39-884_org telegram messenger-edit](https://github.com/user-attachments/assets/3945654d-d39f-4453-8bdc-39bb4815f422)
- позволяет посмотреть **всех** доступных животных
- **задать фильтры**
- и перейти в **управление рассылкой**
---
2. просмотр **всех животных**
![IMG_20250503_212903](https://github.com/user-attachments/assets/73e8322c-e9c7-413f-b3e7-3e9fa9629e63)
- выводит животных, размещенных на сайте приюта в виде инлайн кнопок, по **клику на которые открывается карточка питомца**
---
3. просмотр животных **по фильтрам**
![Screenshot_2025-05-03-21-20-46-354_org telegram messenger-edit](https://github.com/user-attachments/assets/4686357a-62b5-42bf-a7ef-152587671260)
возможно отфильтровать по:
- **возрасту**
- **полу**
- **найти по имени**
---
3.1. фильтрация по возрасту

сначала пользователь выбирает **минимальный возраст** (зависит от минимально доступного в базе данных)
![Screenshot_2025-05-03-21-20-57-633_org telegram messenger-edit](https://github.com/user-attachments/assets/ad0e6c69-3f9c-434e-a89a-66334acd40f5)
и после этого происходит выбор **максимального возраста**. создается диапазон и с помощью SQL-фильтров происходит выборка подходящих пользователю животных. **фильтр сохранятеся в состоянии. при закрытии клавиатуры фильтр сбрасывается**
![Screenshot_2025-05-03-21-21-13-006_org telegram messenger-edit](https://github.com/user-attachments/assets/5c49f7b1-5a29-4b26-bafa-4447b15430d8)

---
3.2. фильтрация по полу

- фильтр также реализован через состояние. 
![Screenshot_2025-05-03-21-21-34-294_org telegram messenger-edit](https://github.com/user-attachments/assets/e8d3d677-9661-4fcb-aace-68ea8e7524d2)

---
3.3. поиск по имени

- достаточно ввести **1 букву и пользователю будет предложены животные, подходящие по его запросу**

---
#### после выбора фильтров: 

с помощью обработчиков **данные, хранящиеся в состоянии формируют SQL-фильтр**, который производит выборку из базы данных и выводит животных, соответствующих фильтрам
![Screenshot_2025-05-03-21-22-08-347_org telegram messenger-edit](https://github.com/user-attachments/assets/e6a870fc-49a2-461a-9f13-eb42fdc99377)
в данном случае нам был выведен пёс Спартак, так как мы выбрали, **что это самец, ему от 0 до 9 лет и уточнили его имя для 100% совпадения**

---
#### 4. карточка питомца 
Она содержит: 

- кличку
- возраст (если был указан на сайте приюта)
- пол
- и кнопку перехода в карточку питомца на сайте
![IMG_20250503_212824](https://github.com/user-attachments/assets/b846f34b-b401-4f8e-aec5-51bb8a12cd93)

---
### 5. Рассылка 
меню управления рассылкой встречает нас управлением всевозможными параметрами.
- добавлением группы/канала **по id**
- **списком наших добавленных каналов**
- **удалением** канала
- и кнопкой назад
![Screenshot_2025-05-03-21-22-24-969_org telegram messenger-edit](https://github.com/user-attachments/assets/eddba32d-2f7d-4c23-bb95-5f47a3b8fb4f)
---
рассмотрим каждый пункт поэтапно 

5.1. добавление канала.
добавление канала происходить в несколько довольно простых и интуитивных шагов.
- отправка боту **id канала или группы** и **назначение его администратором** в ней (в группах бот может работать без админ-прав)
- **установка расписания рассылки** (к примеру ежедневно в 16:00). **бот понимает язык простого человека** и конвертирует время в **формат cron** для последующей работы с **apscheduler**
![Screenshot_2025-05-03-21-23-24-985_org telegram messenger-edit](https://github.com/user-attachments/assets/988fd31c-5222-48aa-9d6e-e695ba942a8b)
-- выбор фильтров. он **аналогичен просмотру по фильтрам** и **не обязателен в рассылке**. можно просто пропустить этот шаг и нажать сохранить 

**после этого формируется задача по данным, введенным пользователем.** 
---
5.2. просмотр добавленных каналов
![IMG_20250503_212558](https://github.com/user-attachments/assets/38755352-210c-458b-8d55-cb40f72dbff3)
тут распологается **вся информация** о рассылке для каждого канала пользователя. 

--- 
5.2. удаление канала 
![IMG_20250503_212639](https://github.com/user-attachments/assets/3886b537-4861-420c-9fca-92d2408b39ed)
простая процедура, которая **удаляет задачу из планировщика** и **удаляет канал из базы данных**

---
#### визуально рассылка выглядит ровно также, как и просмотр карточки животного в боте
---
## Технологии
| компонент продукта | техническое решение |
| ----------- | ----------- |
| бот телеграм   | ![Aiogram](https://img.shields.io/badge/Aiogram-blue)   |
| парсер сайта приюта   | ![fake-headers](https://img.shields.io/badge/fake-headers-yellow), ![BeautifulSoup](https://img.shields.io/badge/BeautifulSoup%20(bs4)-green)   |
| база данных | ![SQLite](https://img.shields.io/badge/sqlite-%2307405e.svg?style=for-the-badge&logo=sqlite&logoColor=white) |
| автоматизация задач | ![APScheduler](https://img.shields.io/badge/APScheduler-orange) |

![Python](https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54)   ![Telegram](https://img.shields.io/badge/Telegram-2CA5E0?style=for-the-badge&logo=telegram&logoColor=white)  
---
### технические подробности 
1. парсер
- работает **асинхронно и обходит блокировки** благодаря fake_headers. **обновляет данные в базе данных кадый день в 13:00** по московскому времени
2. бот
- работает на aiogram, **использует состояния и стандартные возможности библиотеки**
3. app.py
- сердце проекта. в нем распологается **одновременный запуск парсера и бота**, с помощью него **они могут работать непрерывно и не мешая друг другу**
---
## Планы на будущее 
- [ ] добавление рассылки новых животных
- [ ] добавление новых фильтров и возможностей рассылки
- [ ] улучшение оформления бота 
---
<kbd>with :heart: by M.Lust and "Доминаторы 3000"</kbd>
